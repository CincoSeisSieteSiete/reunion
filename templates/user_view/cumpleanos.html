{% extends "base.html" %}

{% block header %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/cumpleanos/base.css') }}">
{% if session.get('tema', 0) == 0 %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/cumpleanos/light.css') }}">
{% else %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/cumpleanos/dark.css') }}">
{% endif %}
{% endblock %}

{% block content %}


{# NAV: Mes anterior / Mes siguiente #}
{% set mes_anterior = mes_actual - 1 %}
{% set year_anterior = year_actual %}
{% if mes_anterior == 0 %}
{% set mes_anterior = 12 %}
{% set year_anterior = year_actual - 1 %}
{% endif %}

{% set mes_siguiente = mes_actual + 1 %}
{% set year_siguiente = year_actual %}
{% if mes_siguiente == 13 %}
{% set mes_siguiente = 1 %}
{% set year_siguiente = year_actual + 1 %}
{% endif %}

<section class="regreso">
    <a href="javascript:history.back()" class="back-link">
        <img src="{{ url_for('static', filename='iconos/arrow-left.svg') }}" alt="Regresar">
    </a>
</section>

<div class="calendar-nav">
    <span class="current-month-year">
        {{
        ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][mes_actual
        - 1] }}
        -
        {{ year_actual }}
    </span>

    <div class="Botones-fecha">
        <a href="?mes={{ mes_anterior }}&year={{ year_anterior }}" class="btn btn-secondary"><img
                src="{{ url_for('static', filename='iconos/izquierda.svg')}}" alt=""></a>
        <a href="?mes={{ mes_siguiente }}&year={{ year_siguiente }}" class="btn btn-secondary"><img
                src="{{ url_for('static', filename='iconos/derecha.svg')}}" alt=""></a>
    </div>
</div>

{# CALENDARIO #}
<div class="calendar-grid">
    {% set dias_semana = ['Lun','Mar','Mié','Jue','Vie','Sáb','Dom'] %}
    {% for dia in dias_semana %}
    <div class="day-header">{{ dia }}</div>
    {% endfor %}

    {# Calcular primer día de la semana para el mes actual #}
    {% set primer_dia_semana = fecha_inicio_mes.weekday() %} {# Lunes=0 #}
    {% for i in range(primer_dia_semana) %}
    <div class="calendar-day inactive"></div>
    {% endfor %}

    {# Días del mes #}
    {% for dia in range(1, dias_mes + 1) %}
    {% set cumple_dia = [] %}
    {% for user in cumpleanos_data %}
    {% if user.mes == mes_actual and user.dia == dia %}
    {% set _ = cumple_dia.append(user.nombre) %}
    {% endif %}
    {% endfor %}
    <div
        class="calendar-day {% if cumple_dia %}has-birthday{% endif %} {% if dia == hoy_real.day and mes_actual == hoy_real.month %}today{% endif %}">
        <span class="day-number">{{ dia }}</span>
        {% for nombre in cumple_dia %}
        <div class="cumple" title="{{ nombre }}">{{ nombre }}</div>
        {% endfor %}
    </div>
    {% endfor %}
</div>

<div class="Lista-Cumpleaños-mes">
    <h2>Lista de cumpleañeros</h2>
    <ul>
        {% for user in cumpleanos_data %}
        {% if user.mes == mes_actual %}
        <li>
            <div class="Dia-cumple">
                {{ user.dia }}
            </div>
            <div class="Nombre-cumple">
                {{ user.nombre }}
            </div>
        </li>
        {% endif %}
        {% endfor %}
    </ul>
</div>

{% endblock %}